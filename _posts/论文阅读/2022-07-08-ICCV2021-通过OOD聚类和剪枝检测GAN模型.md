---
layout: post
title: ICCV2021-通过OOD检测，聚类合并等实现未知GAN图像聚类和检测
categories: 论文阅读
tags: [GAN图像检测,泛化]
topmost: true
description: 现有工作对训练时未见GAN的泛化性不强，提出的算法利用GAN的独特指纹，通过一系列操作实现对未知GAN模型的聚类，包括图像特征提取，OOD检测，图像聚类，类合并，类提炼（拒绝一些点和类），
keywords: 深度学习
last_modifi: 2022年7月21日
---

现有工作对训练时未见GAN的泛化性不强，提出的算法利用GAN的独特指纹，提出的贡献包括模型训练，OOD检测，集群，合并以及细化步骤

## 1. Introduction
找到生成图像的消息来源是非常重要的。\
\
Several networks perform attribution for multiple GAN architectures and **obtain high classification accuracies**\
\
**现有的GAN检测架构通常只能检测到在训练时出现过的GAN架构，无法识别未知GAN**\
<a style="color:#aeaeae"> 
**however they are limited to the closed-world setup as they attribute only to the GANs seen during training and are incapable of identifying unseen GANs.**</a>

作者由此提出了一个新的问题“GAN discovery and attribution”，即是否可以发现这些新的source，并将这些新的source产生的图像聚合到一起。\
<a style="color:#aeaeae"> 
=>**a new question** (GAN discovery and attribution)
 "whether we can discover these new sources and group together the set of images which are generated by them"</a>

GAN图像在生成时通常会留下独特指纹（unique artificial signatures）作者将会利用这些信息归类未见源和已知源\
 <a style="color:#aeaeae"> Many works show that GANs leave **unique artificial signatures in the images** they generate.</a>
 

**作者提出了一种新的iterative pipeline，这种方法利用一组固定的图像，这组图像由它们对应的source所标记，然后对一组unlabeled图像发掘其来源**\
<a style="color:#aeaeae"> Paper proposes a nobel iterative pipeline which utilizes a fixed set of images, labeled according to their corresponding sources, and perform GAN attribution and discovery on an unlabeled set of images.</a>

作者的方法可以推广到open-world setup上，其中unlabeled/discovery图像并不一定要来自labeled class sources，此外因为pipeline的迭代特性，可以持续的从新的GAN模型发掘图像添加到discovery set中。\
 <a style="color:#aeaeae">Our approach generalizes to an open-world
setup where images in the unlabeled/discovery set are not
restricted to be from the labeled class sources. Additionally, due to the iterative nature of our pipeline, we can continuously discover images from new GANs added to our
discovery set in an online manner</a>

**作者的方法只需要真实数据集上的一些标签，以及一些在这些真实数据集上训练得到的GAN模型。每个real/GAN source 代表一个类。**\
**模型可以发掘在真实数据集上训练的未知GAN，以及可以发掘新的真实数据集或在这些真实数据集上训练的GAN，即使在初始的labeled set中没有出现**

为了在open-world的设置中分离unseen / seen 的source，引入了 out-of-distribution (OOD)步骤，即加入了 Winner Take All（WTA) hash等等，详细内容在第三部分进行说明

## 3. Proposed Approach
![]({{ site.url }}\source\post\论文阅读\2022-07-08-ICCV2021-通过OOD聚类和剪枝检测GAN模型/pipeline.png#pic_center)

#### 3.2 Network training
网络包含两部分|
1.feature generation network 使用现成的CNN网络，后接一个全连接层用于降低维数\
2.classification part 使用一个全连接层，后跟softmax层。\
使用cross-entropy loss。在网络训练完成后，作者使用feature generation network提取图像特征。\

#### 3.3 out-of-distribution detection
使用WTA hashing algorithm，这种算法表明，特征向量的序数表示（ordinal representation）提供了很强的非线性变换\

**这个地方还需要再看看**

#### 3.4 clustering
接下来在特征集上运行K-means来集群剩余样本，在这一阶段结束时，所有样本都被分配到一个集群之中，没有样本会被剩下。**然而这个方法会产生大量碎片化的集群，为了减少集群的数量，提高集群的纯度，将在3.5执行Merge和refine。**

#### 3.5 Merge and refine
##### 3.5.1 Merge
作者使用1-Nearest Neighbour graph进行聚类。
##### 3.5.2 Refine
Merge步骤将会降低集群的纯度（许多本不属于该集群的样本被错误的分类）

## 4 Experiments
![]({{ site.url }}\source\post\论文阅读\2022-07-08-ICCV2021-通过OOD聚类和剪枝检测GAN模型/dataset.png#pic_center)
使用ResNet-50作为骨干网络，3层全连接层用于减少维度至128\
另一层全连接层用在feature extractor之上用于分类
整个网络使用有监督方式训练，且使用cross entropy loss
每张图片使用resize，center cropped 到256×256

**使用Average purity以及Normalized Mutual Information（NMI）作为评价指标

